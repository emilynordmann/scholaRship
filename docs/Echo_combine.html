<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 8 Combining Echo360 data with other sources of data in R with tidyverse | scholaRship</title>
<meta name="author" content="Emily Nordmann, Craig Alexander, James Bartlett, Eilidh Jack, Gaby Mahrholz, Jill MacKay, Mitchum Bock">
<meta name="generator" content="bookdown 0.34 with bs4_book()">
<meta property="og:title" content="Chapter 8 Combining Echo360 data with other sources of data in R with tidyverse | scholaRship">
<meta property="og:type" content="book">
<meta property="og:url" content="https://psyteachr.github.io/scholaRship/Echo_combine.html">
<meta property="og:image" content="https://psyteachr.github.io/scholaRship/images/logos/logo.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 8 Combining Echo360 data with other sources of data in R with tidyverse | scholaRship">
<meta name="twitter:image" content="https://psyteachr.github.io/scholaRship/images/logos/logo.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.0/transition.js"></script><script src="libs/bs3compat-0.5.0/tabs.js"></script><script src="libs/bs3compat-0.5.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script><script src="libs/plotly-binding-4.10.2/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-6NP3MF25W3"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-6NP3MF25W3');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="include/psyteachr.css">
<link rel="stylesheet" href="include/webex.css">
<link rel="stylesheet" href="include/style.css">
<meta name="description" content="library(tidyverse) library(plotly) ## ## Attaching package: 'plotly' ## The following object is masked from 'package:ggplot2': ## ##   last_plot ## The following object is masked from...">
<meta property="og:description" content="library(tidyverse) library(plotly) ## ## Attaching package: 'plotly' ## The following object is masked from 'package:ggplot2': ## ##   last_plot ## The following object is masked from...">
<meta name="twitter:description" content="library(tidyverse) library(plotly) ## ## Attaching package: 'plotly' ## The following object is masked from 'package:ggplot2': ## ##   last_plot ## The following object is masked from...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">scholaRship</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="creating-synthetic-datasets.html"><span class="header-section-number">2</span> Creating synthetic datasets</a></li>
<li><a class="" href="moodle-assignment-submission-reports.html"><span class="header-section-number">3</span> Moodle Assignment submission reports</a></li>
<li><a class="" href="anonymous.html"><span class="header-section-number">4</span> Creating Anonymous Data From Synthetic Data</a></li>
<li><a class="" href="workshop.html"><span class="header-section-number">5</span> ALT Conference Prep</a></li>
<li><a class="" href="Echo_tidy.html"><span class="header-section-number">6</span> Getting started with Echo360 data in R with tidyverse</a></li>
<li><a class="" href="Echo_course.html"><span class="header-section-number">7</span> Exploring Echo360 video/course level data in R with tidyverse</a></li>
<li><a class="active" href="Echo_combine.html"><span class="header-section-number">8</span> Combining Echo360 data with other sources of data in R with tidyverse</a></li>
<li class="book-part">Appendices</li>
<li><a class="" href="installing-r.html"><span class="header-section-number">A</span> Installing R</a></li>
<li><a class="" href="symbols.html"><span class="header-section-number">B</span> Symbols</a></li>
<li><a class="" href="conventions.html"><span class="header-section-number">C</span> Conventions</a></li>
<li><a class="" href="license.html">License</a></li>
<li><a class="" href="references-1.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/psyteachr/scholaRship">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="Echo_combine" class="section level1" number="8">
<h1>
<span class="header-section-number">8</span> Combining Echo360 data with other sources of data in R with tidyverse<a class="anchor" aria-label="anchor" href="#Echo_combine"><i class="fas fa-link"></i></a>
</h1>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com">plotly</a></span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Attaching package: 'plotly'</code></pre>
<pre><code>## The following object is masked from 'package:ggplot2':
## 
##     last_plot</code></pre>
<pre><code>## The following object is masked from 'package:stats':
## 
##     filter</code></pre>
<pre><code>## The following object is masked from 'package:graphics':
## 
##     layout</code></pre>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span></span></code></pre></div>
<p>The <code>dplyr</code> package in <code>tidyverse</code> has a number of functions that merge or "join" data. As the <a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">reference page</a> states:</p>
<blockquote>
<p>Mutating joins add columns from y to x, matching observations based on the keys. There are four mutating joins: the inner join, and the three outer joins.</p>
</blockquote>
<blockquote>
<p>Inner join
An inner_join() only keeps observations from x that have a matching key in y.</p>
</blockquote>
<blockquote>
<p>The most important property of an inner join is that unmatched rows in either input are not included in the result. This means that generally inner joins are not appropriate in most analyses, because it is too easy to lose observations.</p>
</blockquote>
<blockquote>
<p>Outer joins
The three outer joins keep observations that appear in at least one of the data frames:</p>
</blockquote>
<blockquote>
<ul>
<li>A left_join() keeps all observations in x.</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>A right_join() keeps all observations in y.</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>A full_join() keeps all observations in x and y.</li>
</ul>
</blockquote>
<p>To illustrate these functions we will consider data from Echo360 together with data from a checklist which records the percentage of tasks that student have marked as complete and also with data containing the results of multiple choice quizzes (MCQ). In both the checklist and MCQ data objects each student only appears once.</p>
<div id="merging-data-where-each-student-only-appears-once-in-each-data-object" class="section level2" number="8.1">
<h2>
<span class="header-section-number">8.1</span> Merging data where each student only appears once in each data object<a class="anchor" aria-label="anchor" href="#merging-data-where-each-student-only-appears-once-in-each-data-object"><i class="fas fa-link"></i></a>
</h2>
<p>If we are interested in combining Echo360 data from just one lecture (and thus where each student will appear once) together with the MCQ data we could follow the following steps.</p>
<ul>
<li>First select the variables of interest from each data object, where <code>Lectures_01</code> contains the Echo360 data from the first lecture.</li>
</ul>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Lecture01_to_merge</span> <span class="op">&lt;-</span> <span class="va">Lecture01</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">user_name</span>,<span class="va">email_address</span>,<span class="va">total_views</span>,<span class="va">total_view_time</span>,<span class="va">average_view_time</span>,<span class="va">last_viewed</span><span class="op">)</span></span>
<span><span class="va">MCQ_to_merge</span> <span class="op">&lt;-</span> <span class="va">MCQ</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">first_name</span>,<span class="va">surname</span>,<span class="va">id_number</span>,<span class="va">email_address</span>,<span class="va">quiz_mcq_summative_assessment_real</span>,<span class="va">quiz_mcq_summative_assessment_perc</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Second, specify the type of 'join', e.g.</li>
</ul>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Lecture01_MCQ_left</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">Lecture01_to_merge</span>,<span class="va">MCQ_to_merge</span>,by <span class="op">=</span> <span class="st">"email_address"</span><span class="op">)</span></span>
<span><span class="va">Lecture01_MCQ_right</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">right_join</a></span><span class="op">(</span><span class="va">Lecture01_to_merge</span>,<span class="va">MCQ_to_merge</span>,by <span class="op">=</span> <span class="st">"email_address"</span><span class="op">)</span></span>
<span><span class="va">Lecture01_MCQ_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">Lecture01_to_merge</span>,<span class="va">MCQ_to_merge</span>,by <span class="op">=</span> <span class="st">"email_address"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Third, check that the input and ouput data objects are as we expect. For example the <code><a href="https://rdrr.io/r/base/dim.html">dim()</a></code> and <code><a href="https://rdrr.io/r/base/names.html">names()</a></code> functions return the dimensions and variable names of each object.</li>
</ul>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">Lecture01_to_merge</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">MCQ_to_merge</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">Lecture01_to_merge</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">MCQ_to_merge</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">Lecture01_MCQ_left</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">Lecture01_MCQ_right</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">Lecture01_MCQ_full</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">Lecture01_MCQ_left</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">Lecture01_MCQ_right</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">Lecture01_MCQ_full</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 67  6
## [1] 243   6
## [1] "user_name"         "email_address"     "total_views"      
## [4] "total_view_time"   "average_view_time" "last_viewed"      
## [1] "first_name"                         "surname"                           
## [3] "id_number"                          "email_address"                     
## [5] "quiz_mcq_summative_assessment_real" "quiz_mcq_summative_assessment_perc"
## [1] 67 11
## [1] 243  11
## [1] 245  11
##  [1] "user_name"                          "email_address"                     
##  [3] "total_views"                        "total_view_time"                   
##  [5] "average_view_time"                  "last_viewed"                       
##  [7] "first_name"                         "surname"                           
##  [9] "id_number"                          "quiz_mcq_summative_assessment_real"
## [11] "quiz_mcq_summative_assessment_perc"
##  [1] "user_name"                          "email_address"                     
##  [3] "total_views"                        "total_view_time"                   
##  [5] "average_view_time"                  "last_viewed"                       
##  [7] "first_name"                         "surname"                           
##  [9] "id_number"                          "quiz_mcq_summative_assessment_real"
## [11] "quiz_mcq_summative_assessment_perc"
##  [1] "user_name"                          "email_address"                     
##  [3] "total_views"                        "total_view_time"                   
##  [5] "average_view_time"                  "last_viewed"                       
##  [7] "first_name"                         "surname"                           
##  [9] "id_number"                          "quiz_mcq_summative_assessment_real"
## [11] "quiz_mcq_summative_assessment_perc"</code></pre>
<p>We note the following properties, each of which are as expected:</p>
<ul>
<li>each type of join/merge returns the same variables</li>
<li>the <code>left</code> join retains all 67 student email addresses listed in the Echo360 <code>Lecture01_to_merge</code> object</li>
<li>the <code>right</code> join retains all 243 student email addresses listed in the <code>MCQ_to_merge</code> object</li>
<li>the <code>full</code> join retains all 245 unique student email addresses listed in both <code>Lecture01_to_merge</code> and <code>MCQ_to_merge</code>. On inspection, there are two observations in <code>Lecture01_to_merge</code> that have missing values (<code>NA</code>) for <code>email_address</code> and these correspond to the two "extra" observations in <code>Lecture01_MCQ_full</code> compared to <code>Lecture01_MCQ_right</code>.</li>
</ul>
</div>
<div id="merging-data-where-each-student-may-appear-more-than-once-in-the-echo360-data" class="section level2" number="8.2">
<h2>
<span class="header-section-number">8.2</span> Merging data where each student may appear more than once in the Echo360 data<a class="anchor" aria-label="anchor" href="#merging-data-where-each-student-may-appear-more-than-once-in-the-echo360-data"><i class="fas fa-link"></i></a>
</h2>
<p>If we are interested in combining Echo360 data from <em>multiple</em> lectures (and thus where students may appear more than once) together with another data object where the students appear only once (such as the checklist and MCQ data described above) then we can still use the <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join()</a></code> function. Despite the function including the argument <code>multiple</code> for the "handling of rows in x with multiple matches in y", this argument is not relevant to our scenario since if the Echo360 data is the <code>x</code> argument and has multiple rows for each student it can be merged with another data source as the <code>y</code> argument (within which each student only appears once) in one of the ways shown previously:</p>
<ul>
<li>First select the variables of interest from each data object, where <code>Lectures_010203</code> contains the Echo360 data from the first three lectures.</li>
</ul>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Lecture010203_to_merge</span> <span class="op">&lt;-</span> <span class="va">Lectures_010203</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">user_name</span>, <span class="va">email_address</span>,<span class="va">media_name</span>,<span class="va">total_views</span>,</span>
<span>         <span class="va">total_view_time</span>,<span class="va">average_view_time</span>,<span class="va">last_viewed</span><span class="op">)</span></span>
<span></span>
<span><span class="va">MCQ_to_merge</span> <span class="op">&lt;-</span> <span class="va">MCQ</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">first_name</span>,<span class="va">surname</span>,<span class="va">id_number</span>,<span class="va">email_address</span>,</span>
<span>         <span class="va">quiz_mcq_summative_assessment_real</span>,<span class="va">quiz_mcq_summative_assessment_perc</span><span class="op">)</span></span></code></pre></div>
<p>NB. Where students may appear more than once, its necessary to include a variable that distinguishes between the repeated appearances. In this case its the variable <code>media_name</code> which identifies the lecture that the Echo360 data is from.</p>
<ul>
<li>Second, specify the type of 'join', in this case there is only one :</li>
</ul>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Lecture010203_MCQ_left</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">Lecture010203_to_merge</span>,<span class="va">MCQ_to_merge</span>,by <span class="op">=</span> <span class="st">"email_address"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Third, check that the input and output data objects are as we expect.</li>
</ul>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">Lecture010203_to_merge</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">MCQ_to_merge</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">Lecture010203_to_merge</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">MCQ_to_merge</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">Lecture010203_MCQ_left</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">Lecture010203_MCQ_left</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 145   7
## [1] 243   6
## [1] "user_name"         "email_address"     "media_name"       
## [4] "total_views"       "total_view_time"   "average_view_time"
## [7] "last_viewed"      
## [1] "first_name"                         "surname"                           
## [3] "id_number"                          "email_address"                     
## [5] "quiz_mcq_summative_assessment_real" "quiz_mcq_summative_assessment_perc"
## [1] 145  12
##  [1] "user_name"                          "email_address"                     
##  [3] "media_name"                         "total_views"                       
##  [5] "total_view_time"                    "average_view_time"                 
##  [7] "last_viewed"                        "first_name"                        
##  [9] "surname"                            "id_number"                         
## [11] "quiz_mcq_summative_assessment_real" "quiz_mcq_summative_assessment_perc"</code></pre>
<p>We note the following property:</p>
<ul>
<li>the <code>left</code> join retains all 145 observations listed in the Echo360 <code>Lecture010203_to_merge</code> object and combines them the (single) corresponding observation in <code>MCQ_to_merge</code>
</li>
</ul>
</div>
<div id="illustration-visualizing-merged-data" class="section level2" number="8.3">
<h2>
<span class="header-section-number">8.3</span> Illustration: Visualizing merged data<a class="anchor" aria-label="anchor" href="#illustration-visualizing-merged-data"><i class="fas fa-link"></i></a>
</h2>
<p>Merging data enables the exploration of how video engagement (recorded in the Echo360 data) is related to student performance. For example, the number of times each student views video content can be combined with their performance in an assessment (such as contained in the the MCQ data above). A visualization of this data can be obtained as follows:</p>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">student_data</span> <span class="op">&lt;-</span> <span class="va">Lectures_010203</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">email_address</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>total_views<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">total_views</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_at</a></span><span class="op">(</span><span class="st">'email_address'</span>, <span class="va">factor</span><span class="op">)</span></span>
<span></span>
<span><span class="va">student_MCQ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">student_data</span>,<span class="va">MCQ_to_merge</span>,by <span class="op">=</span> <span class="st">"email_address"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fig.no_viewed.mcq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">student_MCQ</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">total_views</span>, y<span class="op">=</span><span class="va">quiz_mcq_summative_assessment_perc</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Number of video views vs. Percentage Score in a Multiple Choice Quiz"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Percentage Score in MCQ"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"No. of video views"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fig.no_viewed.mcq</span></span></code></pre></div>
<div class="inline-figure"><img src="08-Echo_combine_files/figure-html/merge_plot-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>The plot can be made interactive using the <code><a href="https://rdrr.io/pkg/plotly/man/plotly.html">plotly()</a></code> funciton as illustrated in previous sections.</p>

</div>
</div>



<div class="chapter-nav">
<div class="prev"><a href="Echo_course.html"><span class="header-section-number">7</span> Exploring Echo360 video/course level data in R with tidyverse</a></div>
<div class="next"><a href="installing-r.html"><span class="header-section-number">A</span> Installing R</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#Echo_combine"><span class="header-section-number">8</span> Combining Echo360 data with other sources of data in R with tidyverse</a></li>
<li><a class="nav-link" href="#merging-data-where-each-student-only-appears-once-in-each-data-object"><span class="header-section-number">8.1</span> Merging data where each student only appears once in each data object</a></li>
<li><a class="nav-link" href="#merging-data-where-each-student-may-appear-more-than-once-in-the-echo360-data"><span class="header-section-number">8.2</span> Merging data where each student may appear more than once in the Echo360 data</a></li>
<li><a class="nav-link" href="#illustration-visualizing-merged-data"><span class="header-section-number">8.3</span> Illustration: Visualizing merged data</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/psyteachr/scholaRship/blob/master/book/08-Echo_combine.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/psyteachr/scholaRship/edit/master/book/08-Echo_combine.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;

    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    $(solveme[i]).after(" <span class='webex-icon'></span>");
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    $(selects[i]).after(" <span class='webex-icon'></span>");
  }

  update_total_correct();
}

</script><script>
$( document ).ready(function() {
  var cite = ' ';
  var psyteachr = ' <a href="https://psyteachr.github.io/"><img src="images/logos/psyteachr_logo.png" style="height: 31px; color: white;" alt="psyTeachR: Reproducible Research" /></a>';
  var license = ' <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="blank"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>';

  $("footer div.row div:eq(1) p").html(
    psyteachr + license + cite
  );

  // open rdrr links externally
  $("a[href^='https://rdrr.io']").click(function(){
    window.open(this.href);
    return false;
  });

  // visible second sidebar in mobile
  function move_sidebar() {
    var w = window.innerWidth;
    if (w < 992) {
      $("#toc").appendTo($("#main-nav"));
    } else {
      $("#toc").appendTo($("div.sidebar-chapter"));
    }
  }
  move_sidebar();
  window.onresize = move_sidebar;
});
</script>

</div>
 <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>scholaRship</strong>" was written by Emily Nordmann, Craig Alexander, James Bartlett, Eilidh Jack, Gaby Mahrholz, Jill MacKay, Mitchum Bock. It was last built on 2023-08-15.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
